
////////////////////////////////////////////////////////////////////////////////
//
// All Rights Reserved, Copyright(C),2013
// Licenced Material of by zhaoyiwei
// This file is auto generated by IOLibMaker, Do NOT modify
//
////////////////////////////////////////////////////////////////////////////////
//
// SubSystem: NDS_UpdDownloadInfoNDS_UpdDownloadInfoのデ`タアクセス用のライブラリ
// Class Name:    NDS_UpdDownloadInfoNDS_UpdDownloadInfoのきzむ用のクラス
//
////////////////////////////////////////////////////////////////////////////////
#include	"InnerCommon.h"
#include	"NDS_UpdCommon_Struct.h"
#include	"NDS_UpdCommon_OutsideRef.h"
#include	"NDS_UpdCommon_InsideRef.h"
#include	"NDS_UpdCommon_FormatStructure.h"
#include	"NDS_UpdCommon_Writer.h"
#include	"NDS_UpdDownloadInfo_Struct.h"
#include	"NDS_UpdDownloadInfo_OutsideRef.h"
#include	"NDS_UpdDownloadInfo_InsideRef.h"
#include	"NDS_UpdDownloadInfo_FormatStructure.h"
#include	"NDS_UpdDownloadInfo_Writer.h"


////////////////////////////////////////////////////////////////////////////////
//
// Function: NDS_UpdDownloadInfoNDS_UpdDownloadInfoコンストラクタ`
// Detail: NDS_UpdDownloadInfoNDS_UpdDownloadInfoクラスの初期化
// Return:None
////////////////////////////////////////////////////////////////////////////////
CNDS_UpdDownloadInfo_Writer::CNDS_UpdDownloadInfo_Writer()
{
}

////////////////////////////////////////////////////////////////////////////////
//
// Function: NDS_UpdDownloadInfoNDS_UpdDownloadInfoコンストラクタ`
// Detail: NDS_UpdDownloadInfoNDS_UpdDownloadInfoクラスの初期化
// Return:None
////////////////////////////////////////////////////////////////////////////////
CNDS_UpdDownloadInfo_Writer::CNDS_UpdDownloadInfo_Writer( SmartPointer<CMyOfstream> &pclStream, SmartPointer<CBaseFormatStructure> &pclFormatStructure )
	: CIOLibBaseWriter( pclStream, pclFormatStructure )
{
}


////////////////////////////////////////////////////////////////////////////////
//
// Function: NDS_UpdDownloadInfoNDS_UpdDownloadInfoディストラクタ`
// Detail: NDS_UpdDownloadInfoNDS_UpdDownloadInfoクラスの削除
// Return:None
////////////////////////////////////////////////////////////////////////////////
CNDS_UpdDownloadInfo_Writer::~CNDS_UpdDownloadInfo_Writer()
{
}


////////////////////////////////////////////////////////////////////////////////
//
// Function: CreateFormatStructure
// Detail: Create meta data class of format for WriteBack.
// Return:int 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////
int CNDS_UpdDownloadInfo_Writer::CreateFormatStructure( SmartPointer<CBaseFormatStructure> &spclFormatStructure )
{
	spclFormatStructure.CreateEx( Type2Type<CNDS_UpdDownloadInfo_FormatStructure>() );
	if( NULL == m_pclFormatStructure.Get() ) {
		assert( 0 );
		return FAILURE;
	}
	return SUCCESS;
}



////////////////////////////////////////////////////////////////////////////////
//
// Function: Write_NDS_UpdUpdateId
// Detail: 当するフォ`マットのNDS_UpdUpdateIdレコ`ドをきzむ
// Return:long 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////
long CNDS_UpdDownloadInfo_Writer::WriteNDS_UpdUpdateId( const CNDS_UpdUpdateId &clNDS_UpdUpdateId )
{
	uint64	ullUpdateId_REC_START_DA	=	m_pclStream->GetDA();
	if( SUCCESS != m_pclStream->PutMBCString( clNDS_UpdUpdateId.m_strUpdateId ) ) {
		assert( 0 );
		return FAILURE;
	}
	while( ( m_pclStream->GetDA() - ullUpdateId_REC_START_DA ) % 32 > 0 ) {
		char	c	=	0;
		if( SUCCESS != m_pclStream->Put1bN( c ) ) {
			return FAILURE;
		}
	}

	return SUCCESS;
}


////////////////////////////////////////////////////////////////////////////////
//
// Function: Write_NDS_UpdDownloadInfoDataFrame
// Detail: 当するフォ`マットのNDS_UpdDownloadInfoDataFrameレコ`ドをきzむ
// Return:long 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////
long CNDS_UpdDownloadInfo_Writer::WriteNDS_UpdDownloadInfoDataFrame( const CNDS_UpdDownloadInfoDataFrame &clNDS_UpdDownloadInfoDataFrame )
{
	if( SUCCESS != WriteNDS_UpdUpdateId( clNDS_UpdDownloadInfoDataFrame.m_clUpdateId ) ) {
		assert( 0 );
		return FAILURE;
	}

	if( SUCCESS != m_pclStream->Put4bN( clNDS_UpdDownloadInfoDataFrame.m_uiFileCount ) ) {
		assert( 0 );
		return FAILURE;
	}

	return SUCCESS;
}


////////////////////////////////////////////////////////////////////////////////
//
// Function: CalcSize_NDS_UpdUpdateId
// Detail: NDS_UpdUpdateIdをきzむSizeを算する
// Return:long 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////
uint64 CNDS_UpdDownloadInfo_Writer::CalSizeNDS_UpdUpdateId( const CNDS_UpdUpdateId &clNDS_UpdUpdateId )
{
	uint64	ullResultSize	=	0;
	uint64	ullUpdateId_REC_START_DA	=	ullResultSize;
	ullResultSize	+=	CMyOfstream::CalSizeMBCString( clNDS_UpdUpdateId.m_strUpdateId );
	ullResultSize	+=	( ( ullResultSize - ullUpdateId_REC_START_DA ) % 32 );

	return ullResultSize;
}


////////////////////////////////////////////////////////////////////////////////
//
// Function: CalcSize_NDS_UpdDownloadInfoDataFrame
// Detail: NDS_UpdDownloadInfoDataFrameをきzむSizeを算する
// Return:long 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////
uint64 CNDS_UpdDownloadInfo_Writer::CalSizeNDS_UpdDownloadInfoDataFrame( const CNDS_UpdDownloadInfoDataFrame &clNDS_UpdDownloadInfoDataFrame )
{
	uint64	ullResultSize	=	0;
	ullResultSize	+=	CalSizeNDS_UpdUpdateId( clNDS_UpdDownloadInfoDataFrame.m_clUpdateId );

	ullResultSize	+=	CMyOfstream::CalSize4bN( clNDS_UpdDownloadInfoDataFrame.m_uiFileCount );

	return ullResultSize;
}

////////////////////////////////////////////////////////////////////////////////
//
// Function: SolveInsideRef
// Detail: 当するフォ`マットの中のvS(offsetと数など)ををすべてWriteBack
// Return:long 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////

int CNDS_UpdDownloadInfo_Writer::SolveInsideRef()
{
	return SUCCESS;
}


////////////////////////////////////////////////////////////////////////////////
//
// Function: WriteAll
// Detail: 当するファイルをすべてiみzむ
// Return:long 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////
long CNDS_UpdDownloadInfo_Writer::WriteAll( const tchar *ptcFileName, const CNDS_UpdDownloadInfoDataFrame &clNDS_UpdDownloadInfoDataFrame )
{
	if( SUCCESS != Initialize( ptcFileName ) ) {
		assert( 0 );
		return FAILURE;
	}

	if( SUCCESS != WriteNDS_UpdDownloadInfoDataFrame( clNDS_UpdDownloadInfoDataFrame) ) {
		assert( 0 );
		return FAILURE;
	}

	if( SUCCESS != SolveInsideRef() ) {
		assert( 0 );
		return FAILURE;
	}

	return SUCCESS;
}


////////////////////////////////////////////////////////////////////////////////
//
// Function: WriteAll
// Detail: 当するファイルをすべてiみzむ
// Return:long 型
//               SUCCESS  : (Succeeded)             
//               FAILURE : (Failed)
////////////////////////////////////////////////////////////////////////////////
long CNDS_UpdDownloadInfo_Writer::WriteAll( const CNDS_UpdDownloadInfoDataFrame &clNDS_UpdDownloadInfoDataFrame )
{
	if( SUCCESS != Initialize() ) {
		assert( 0 );
		return FAILURE;
	}

	if( SUCCESS != WriteNDS_UpdDownloadInfoDataFrame( clNDS_UpdDownloadInfoDataFrame) ) {
		assert( 0 );
		return FAILURE;
	}

	if( SUCCESS != SolveInsideRef() ) {
		assert( 0 );
		return FAILURE;
	}

	return SUCCESS;
}
